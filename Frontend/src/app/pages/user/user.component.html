<div class="registrations-container" *ngIf="!isLoading; else loading">
  <h2>I tuoi eventi registrati</h2>

  <div *ngIf="registeredEvents.length === 0" class="empty-state">
    <p>Non sei iscritto ad alcun evento.</p>
  </div>

  <mat-card class="event-card" *ngFor="let registration of registeredEvents">
    <mat-card-header>
      <mat-card-title>{{ registration.event.title }}</mat-card-title>
      <mat-card-subtitle>
        {{ registration.event.date | date : "dd/MM/yyyy" }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p>
        {{
          registration.event.description || "Nessuna descrizione disponibile."
        }}
      </p>

      <p *ngIf="registration.checkinEffettuato; else notCheckedIn">
        ✅ Check-in effettuato
      </p>
      <ng-template #notCheckedIn>
        <p>⏳ Check-in non ancora effettuato</p>
      </ng-template>
    </mat-card-content>
    <mat-card-actions
      *ngIf="
        !registration.checkinEffettuato &&
        isDayBeforeEvent(registration.event.date)
      "
    >
      <button
        mat-raised-button
        color="warn"
        (click)="onUnregister(registration)"
      >
        Annulla iscrizione
      </button>
    </mat-card-actions>
  </mat-card>
</div>

<ng-template #loading>
  <div class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
  </div>
</ng-template>
