<div class="checkin-container" role="main" aria-label="Check-in Operatore">
  <h2>Check-in Operatore</h2>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Seleziona Utente</mat-label>
    <mat-select
      [(value)]="selectedUserId"
      (selectionChange)="onUserSelected($event.value)"
      aria-required="true"
      aria-describedby="user-help"
    >
      <mat-option *ngFor="let user of users" [value]="user.id">
        {{ user.firstName }} {{ user.lastName }}
      </mat-option>
    </mat-select>
    <mat-hint id="user-help"
      >Scegli l'utente per visualizzare gli eventi</mat-hint
    >
  </mat-form-field>

  <mat-form-field
    appearance="outline"
    class="full-width"
    *ngIf="eventsForUser.length > 0"
  >
    <mat-label>Seleziona Evento</mat-label>
    <mat-select
      [(value)]="selectedEventId"
      aria-required="true"
      aria-describedby="event-help"
    >
      <mat-option *ngFor="let event of eventsForUser" [value]="event.id">
        {{ event.title }} - {{ event.date | date : "shortDate" }}
      </mat-option>
    </mat-select>
    <mat-hint id="event-help"
      >Scegli l'evento per effettuare il check-in</mat-hint
    >
  </mat-form-field>

  <p
    *ngIf="eventsForUser.length === 0 && selectedUserId"
    class="info-message"
    role="alert"
  >
    Nessun evento disponibile per lâ€™utente selezionato.
  </p>

  <button
    mat-raised-button
    color="primary"
    (click)="performCheckin()"
    [disabled]="isLoading || !selectedUserId || !selectedEventId"
    class="full-width"
    aria-live="polite"
  >
    <mat-icon *ngIf="!isLoading">assignment_turned_in</mat-icon>
    <mat-progress-spinner
      *ngIf="isLoading"
      diameter="20"
      mode="indeterminate"
      color="accent"
    ></mat-progress-spinner>
    <span *ngIf="!isLoading">Avvia Check-in</span>
    <span *ngIf="isLoading">In corso...</span>
  </button>

  <p class="message" *ngIf="message" role="alert">{{ message }}</p>
</div>
